# python:3.8-busteイメージを使用する
FROM python:3.8-buster as builder
LABEL maintainer = "test"
# 標準出力に出力されるバッファを無効化する('1'じゃなくてもいい)
ENV PYTHONBUFFERED 1
# ソース側のマシンにあるrequirements.txtをImage側のマシンへコピーする。
COPY ./requirements.txt /requirements.txt
# pipコマンドを最新にし、requirements.txtファイル内のパッケージをpipインストールする。
RUN pip install --upgrade pip && pip install -r /requirements.txt
# 作業ディレクトリ作成
RUN mkdir /api
# 作業ディレクトリ設定
WORKDIR /api
# カレントディレクトリの資産をコンテナ上の指定のディレクトリにコピー
COPY api/ /api/
# 起動（コンテナのポート3000番で受け付けるように起動する）
CMD python3 manage.py runserver 0.0.0.0:3000
EXPOSE 3000